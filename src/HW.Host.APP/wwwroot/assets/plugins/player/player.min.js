/* * 宅音乐播放器JS文件 * Author：Mr.Fang * QQ：2875616188 * Version：2.2.1 * WebSite：https://fanghua.host * Time：2020.3.27 * Disclaimer: 插件修改于明月浩空免费版，仅用于学习交流，无商业价值 *             如发现商业传播，将禁止软件的免费使用 */
if ("undefined" == typeof jQuery) throw new Error("请先加载jQuery插件！"); !function (a) { "function" == typeof define && define.amd ? define(["jquery"], a) : "object" == typeof exports ? module.exports = a : a(jQuery) }((function (c) { var d = ["wheel", "mousewheel", "DOMMouseScroll", "MozMousePixelScroll"], k = "onwheel" in document || document.documentMode >= 9 ? ["wheel"] : ["mousewheel", "DomMouseScroll", "MozMousePixelScroll"], h = Array.prototype.slice, j, b; if (c.event.fixHooks) for (var e = d.length; e;)c.event.fixHooks[d[--e]] = c.event.mouseHooks; var f = c.event.special.mousewheel = { version: "3.1.9", setup: function () { if (this.addEventListener) for (var m = k.length; m;)this.addEventListener(k[--m], l, !1); else this.onmousewheel = l; c.data(this, "mousewheel-line-height", f.getLineHeight(this)), c.data(this, "mousewheel-page-height", f.getPageHeight(this)) }, teardown: function () { if (this.removeEventListener) for (var m = k.length; m;)this.removeEventListener(k[--m], l, !1); else this.onmousewheel = null }, getLineHeight: function (i) { return parseInt(c(i)["offsetParent" in c.fn ? "offsetParent" : "parent"]().css("fontSize"), 10) }, getPageHeight: function (i) { return c(i).height() }, settings: { adjustOldDeltas: !0 } }; function l(i) { var n = i || window.event, r = h.call(arguments, 1), t = 0, p = 0, o = 0, q = 0; if ((i = c.event.fix(n)).type = "mousewheel", "detail" in n && (o = -1 * n.detail), "wheelDelta" in n && (o = n.wheelDelta), "wheelDeltaY" in n && (o = n.wheelDeltaY), "wheelDeltaX" in n && (p = -1 * n.wheelDeltaX), "axis" in n && n.axis === n.HORIZONTAL_AXIS && (p = -1 * o, o = 0), t = 0 === o ? p : o, "deltaY" in n && (t = o = -1 * n.deltaY), "deltaX" in n && (p = n.deltaX, 0 === o && (t = -1 * p)), 0 !== o || 0 !== p) { if (1 === n.deltaMode) { var s = c.data(this, "mousewheel-line-height"); t *= s, o *= s, p *= s } else if (2 === n.deltaMode) { var m = c.data(this, "mousewheel-page-height"); t *= m, o *= m, p *= m } return q = Math.max(Math.abs(o), Math.abs(p)), (!b || q < b) && (b = q, a(n, q) && (b /= 40)), a(n, q) && (t /= 40, p /= 40, o /= 40), t = Math[t >= 1 ? "floor" : "ceil"](t / b), p = Math[p >= 1 ? "floor" : "ceil"](p / b), o = Math[o >= 1 ? "floor" : "ceil"](o / b), i.deltaX = p, i.deltaY = o, i.deltaFactor = b, i.deltaMode = 0, r.unshift(i, t, p, o), j && clearTimeout(j), j = setTimeout(g, 200), (c.event.dispatch || c.event.handle).apply(this, r) } } function g() { b = null } function a(m, i) { return f.settings.adjustOldDeltas && "mousewheel" === m.type && i % 120 == 0 } c.fn.extend({ mousewheel: function (i) { return i ? this.bind("mousewheel", i) : this.trigger("mousewheel") }, unmousewheel: function (i) { return this.unbind("mousewheel", i) } }) })), function (c) { var b = { init: function (e) { var f = { set_width: !1, set_height: !1, horizontalScroll: !1, scrollInertia: 950, mouseWheel: !0, mouseWheelPixels: "auto", autoDraggerLength: !0, autoHideScrollbar: !1, alwaysShowScrollbar: !1, snapAmount: null, snapOffset: 0, scrollButtons: { enable: !1, scrollType: "continuous", scrollSpeed: "auto", scrollAmount: 40 }, advanced: { updateOnBrowserResize: !0, updateOnContentResize: !1, autoExpandHorizontalScroll: !1, autoScrollOnFocus: !0, normalizeMouseWheelDelta: !1 }, contentTouchScroll: !0, callbacks: { onScrollStart: function () { }, onScroll: function () { }, onTotalScroll: function () { }, onTotalScrollBack: function () { }, onTotalScrollOffset: 0, onTotalScrollBackOffset: 0, whileScrolling: function () { } }, theme: "light" }, e = c.extend(!0, f, e); return this.each((function () { var m = c(this); if (e.set_width && m.css("width", e.set_width), e.set_height && m.css("height", e.set_height), c(document).data("mCustomScrollbar-index")) { var t = parseInt(c(document).data("mCustomScrollbar-index")); c(document).data("mCustomScrollbar-index", t + 1) } else c(document).data("mCustomScrollbar-index", "1"); m.wrapInner("<div class='mCustomScrollBox mCS-" + e.theme + "' id='mCSB_" + c(document).data("mCustomScrollbar-index") + "' style='position:relative; height:100%; overflow:hidden; max-width:100%;' />").addClass("mCustomScrollbar _mCS_" + c(document).data("mCustomScrollbar-index")); var g = m.children(".mCustomScrollBox"); if (e.horizontalScroll) { g.addClass("mCSB_horizontal").wrapInner("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />"); var k = g.children(".mCSB_h_wrapper"); k.wrapInner("<div class='mCSB_container' style='position:absolute; left:0;' />").children(".mCSB_container").css({ width: k.children().outerWidth(), position: "relative" }).unwrap() } else g.wrapInner("<div class='mCSB_container' style='position:relative; top:0;' />"); var o = g.children(".mCSB_container"); c.support.touch && o.addClass("mCS_touch"), o.after("<div class='mCSB_scrollTools' style='position:absolute;'><div class='mCSB_draggerContainer'><div class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' style='position:relative;'></div></div><div class='mCSB_draggerRail'></div></div></div>"); var l = g.children(".mCSB_scrollTools"), h, q = l.children(".mCSB_draggerContainer").children(".mCSB_dragger"); if (e.horizontalScroll ? q.data("minDraggerWidth", q.width()) : q.data("minDraggerHeight", q.height()), e.scrollButtons.enable && (e.horizontalScroll ? l.prepend("<a class='mCSB_buttonLeft' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonRight' oncontextmenu='return false;'></a>") : l.prepend("<a class='mCSB_buttonUp' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonDown' oncontextmenu='return false;'></a>")), g.bind("scroll", (function () { m.is(".mCS_disabled") || g.scrollTop(0).scrollLeft(0) })), m.data({ mCS_Init: !0, mCustomScrollbarIndex: c(document).data("mCustomScrollbar-index"), horizontalScroll: e.horizontalScroll, scrollInertia: e.scrollInertia, scrollEasing: "mcsEaseOut", mouseWheel: e.mouseWheel, mouseWheelPixels: e.mouseWheelPixels, autoDraggerLength: e.autoDraggerLength, autoHideScrollbar: e.autoHideScrollbar, alwaysShowScrollbar: e.alwaysShowScrollbar, snapAmount: e.snapAmount, snapOffset: e.snapOffset, scrollButtons_enable: e.scrollButtons.enable, scrollButtons_scrollType: e.scrollButtons.scrollType, scrollButtons_scrollSpeed: e.scrollButtons.scrollSpeed, scrollButtons_scrollAmount: e.scrollButtons.scrollAmount, autoExpandHorizontalScroll: e.advanced.autoExpandHorizontalScroll, autoScrollOnFocus: e.advanced.autoScrollOnFocus, normalizeMouseWheelDelta: e.advanced.normalizeMouseWheelDelta, contentTouchScroll: e.contentTouchScroll, onScrollStart_Callback: e.callbacks.onScrollStart, onScroll_Callback: e.callbacks.onScroll, onTotalScroll_Callback: e.callbacks.onTotalScroll, onTotalScrollBack_Callback: e.callbacks.onTotalScrollBack, onTotalScroll_Offset: e.callbacks.onTotalScrollOffset, onTotalScrollBack_Offset: e.callbacks.onTotalScrollBackOffset, whileScrolling_Callback: e.callbacks.whileScrolling, bindEvent_scrollbar_drag: !1, bindEvent_content_touch: !1, bindEvent_scrollbar_click: !1, bindEvent_mousewheel: !1, bindEvent_buttonsContinuous_y: !1, bindEvent_buttonsContinuous_x: !1, bindEvent_buttonsPixels_y: !1, bindEvent_buttonsPixels_x: !1, bindEvent_focusin: !1, bindEvent_autoHideScrollbar: !1, mCSB_buttonScrollRight: !1, mCSB_buttonScrollLeft: !1, mCSB_buttonScrollDown: !1, mCSB_buttonScrollUp: !1 }), e.horizontalScroll) "none" !== m.css("max-width") && (e.advanced.updateOnContentResize || (e.advanced.updateOnContentResize = !0)); else if ("none" !== m.css("max-height")) { var s = !1, r = parseInt(m.css("max-height")); m.css("max-height").indexOf("%") >= 0 && (s = r, r = m.parent().height() * s / 100), m.css("overflow", "hidden"), g.css("max-height", r) } if (m.mCustomScrollbar("update"), e.advanced.updateOnBrowserResize) { var i, j = c(window).width(), u = c(window).height(); c(window).bind("resize." + m.data("mCustomScrollbarIndex"), (function () { i && clearTimeout(i), i = setTimeout((function () { if (!m.is(".mCS_disabled") && !m.is(".mCS_destroyed")) { var w = c(window).width(), v = c(window).height(); j === w && u === v || ("none" !== m.css("max-height") && s && g.css("max-height", m.parent().height() * s / 100), m.mCustomScrollbar("update"), j = w, u = v) } }), 150) })) } if (e.advanced.updateOnContentResize) { var p; if (e.horizontalScroll) var n = o.outerWidth(); else var n = o.outerHeight(); p = setInterval((function () { if (e.horizontalScroll) { e.advanced.autoExpandHorizontalScroll && o.css({ position: "absolute", width: "auto" }).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({ width: o.outerWidth(), position: "relative" }).unwrap(); var v = o.outerWidth() } else var v = o.outerHeight(); v != n && (m.mCustomScrollbar("update"), n = v) }), 300) } })) }, update: function () { var n = c(this), k = n.children(".mCustomScrollBox"), q = k.children(".mCSB_container"); q.removeClass("mCS_no_scrollbar"), n.removeClass("mCS_disabled mCS_destroyed"), k.scrollTop(0).scrollLeft(0); var y = k.children(".mCSB_scrollTools"), o = y.children(".mCSB_draggerContainer"), m = o.children(".mCSB_dragger"); if (n.data("horizontalScroll")) { var A = y.children(".mCSB_buttonLeft"), t = y.children(".mCSB_buttonRight"), f = k.width(); n.data("autoExpandHorizontalScroll") && q.css({ position: "absolute", width: "auto" }).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({ width: q.outerWidth(), position: "relative" }).unwrap(); var z = q.outerWidth() } else var w = y.children(".mCSB_buttonUp"), g = y.children(".mCSB_buttonDown"), r = k.height(), i = q.outerHeight(); if (i > r && !n.data("horizontalScroll")) { y.css("display", "block"); var s = o.height(); if (n.data("autoDraggerLength")) { var u = Math.round(r / i * s), l = m.data("minDraggerHeight"); if (u <= l) m.css({ height: l }); else if (u >= s - 10) { var p = s - 10; m.css({ height: p }) } else m.css({ height: u }); m.children(".mCSB_dragger_bar").css({ "line-height": m.height() + "px" }) } var B, x = (i - r) / (s - m.height()); n.data("scrollAmount", x).mCustomScrollbar("scrolling", k, q, o, m, w, g, A, t); var D = Math.abs(q.position().top); n.mCustomScrollbar("scrollTo", D, { scrollInertia: 0, trigger: "internal" }) } else if (z > f && n.data("horizontalScroll")) { y.css("display", "block"); var h = o.width(); if (n.data("autoDraggerLength")) { var j = Math.round(f / z * h), C = m.data("minDraggerWidth"); if (j <= C) m.css({ width: C }); else if (j >= h - 10) { var e = h - 10; m.css({ width: e }) } else m.css({ width: j }) } var v, x = (z - f) / (h - m.width()); n.data("scrollAmount", x).mCustomScrollbar("scrolling", k, q, o, m, w, g, A, t); var D = Math.abs(q.position().left); n.mCustomScrollbar("scrollTo", D, { scrollInertia: 0, trigger: "internal" }) } else k.unbind("mousewheel focusin"), n.data("horizontalScroll") ? m.add(q).css("left", 0) : m.add(q).css("top", 0), n.data("alwaysShowScrollbar") ? n.data("horizontalScroll") ? n.data("horizontalScroll") && m.css({ width: o.width() }) : m.css({ height: o.height() }) : (y.css("display", "none"), q.addClass("mCS_no_scrollbar")), n.data({ bindEvent_mousewheel: !1, bindEvent_focusin: !1 }) }, scrolling: function (i, q, n, k, A, f, D, w) { var l = c(this), o, p, C, z, e, m, E, s, t, v, F, H; l.data("bindEvent_scrollbar_drag") || (c.support.pointer ? (C = "pointerdown", z = "pointermove", e = "pointerup") : c.support.msPointer && (C = "MSPointerDown", z = "MSPointerMove", e = "MSPointerUp"), c.support.pointer || c.support.msPointer ? (k.bind(C, (function (K) { K.preventDefault(), l.data({ on_drag: !0 }), k.addClass("mCSB_dragger_onDrag"); var J = c(this), M = J.offset(), I = K.originalEvent.pageX - M.left, L = K.originalEvent.pageY - M.top; I < J.width() && I > 0 && L < J.height() && L > 0 && (o = L, p = I) })), c(document).bind(z + "." + l.data("mCustomScrollbarIndex"), (function (K) { if (K.preventDefault(), l.data("on_drag")) { var J, M = k.offset(), I = K.originalEvent.pageX - M.left, L = K.originalEvent.pageY - M.top; G(o, p, L, I) } })).bind(e + "." + l.data("mCustomScrollbarIndex"), (function (x) { l.data({ on_drag: !1 }), k.removeClass("mCSB_dragger_onDrag") }))) : (k.bind("mousedown touchstart", (function (K) { K.preventDefault(), K.stopImmediatePropagation(); var J = c(this), N = J.offset(), I, M; if ("touchstart" === K.type) { var L = K.originalEvent.touches[0] || K.originalEvent.changedTouches[0]; I = L.pageX - N.left, M = L.pageY - N.top } else l.data({ on_drag: !0 }), k.addClass("mCSB_dragger_onDrag"), I = K.pageX - N.left, M = K.pageY - N.top; I < J.width() && I > 0 && M < J.height() && M > 0 && (o = M, p = I) })).bind("touchmove", (function (K) { K.preventDefault(), K.stopImmediatePropagation(); var N = K.originalEvent.touches[0] || K.originalEvent.changedTouches[0], J, M = c(this).offset(), I = N.pageX - M.left, L = N.pageY - M.top; G(o, p, L, I) })), c(document).bind("mousemove." + l.data("mCustomScrollbarIndex"), (function (K) { if (l.data("on_drag")) { var J, M = k.offset(), I = K.pageX - M.left, L = K.pageY - M.top; G(o, p, L, I) } })).bind("mouseup." + l.data("mCustomScrollbarIndex"), (function (x) { l.data({ on_drag: !1 }), k.removeClass("mCSB_dragger_onDrag") }))), l.data({ bindEvent_scrollbar_drag: !0 })); function G(J, K, L, I) { l.data("horizontalScroll") ? l.mCustomScrollbar("scrollTo", k.position().left - K + I, { moveDragger: !0, trigger: "internal" }) : l.mCustomScrollbar("scrollTo", k.position().top - J + L, { moveDragger: !0, trigger: "internal" }) } c.support.touch && l.data("contentTouchScroll") && (l.data("bindEvent_content_touch") || (q.bind("touchstart", (function (x) { x.stopImmediatePropagation(), m = x.originalEvent.touches[0] || x.originalEvent.changedTouches[0], E = c(this), s = E.offset(), v = m.pageX - s.left, t = m.pageY - s.top, F = t, H = v })), q.bind("touchmove", (function (x) { x.preventDefault(), x.stopImmediatePropagation(), m = x.originalEvent.touches[0] || x.originalEvent.changedTouches[0], E = c(this).parent(), s = E.offset(), v = m.pageX - s.left, t = m.pageY - s.top, l.data("horizontalScroll") ? l.mCustomScrollbar("scrollTo", H - v, { trigger: "internal" }) : l.mCustomScrollbar("scrollTo", F - t, { trigger: "internal" }) })))); if (l.data("bindEvent_scrollbar_click") || (n.bind("click", (function (I) { var x = (I.pageY - n.offset().top) * l.data("scrollAmount"), y = c(I.target); l.data("horizontalScroll") && (x = (I.pageX - n.offset().left) * l.data("scrollAmount")), (y.hasClass("mCSB_draggerContainer") || y.hasClass("mCSB_draggerRail")) && l.mCustomScrollbar("scrollTo", x, { trigger: "internal", scrollEasing: "draggerRailEase" }) })), l.data({ bindEvent_scrollbar_click: !0 })), l.data("mouseWheel") && (l.data("bindEvent_mousewheel") || (i.bind("mousewheel", (function (K, M) { var J, I = l.data("mouseWheelPixels"), x = Math.abs(q.position().top), L = k.position().top, y = n.height() - k.height(); l.data("normalizeMouseWheelDelta") && (M = M < 0 ? -1 : 1), "auto" === I && (I = 100 + Math.round(l.data("scrollAmount") / 2)), l.data("horizontalScroll") && (L = k.position().left, y = n.width() - k.width(), x = Math.abs(q.position().left)), (M > 0 && 0 !== L || M < 0 && L !== y) && (K.preventDefault(), K.stopImmediatePropagation()), J = x - M * I, l.mCustomScrollbar("scrollTo", J, { trigger: "internal" }) })), l.data({ bindEvent_mousewheel: !0 }))), l.data("scrollButtons_enable")) if ("pixels" === l.data("scrollButtons_scrollType")) { function r(x) { k.data("preventAction") || (k.data("preventAction", !0), l.mCustomScrollbar("scrollTo", x, { trigger: "internal" })) } l.data("horizontalScroll") ? (w.add(D).unbind("mousedown touchstart MSPointerDown pointerdown mouseup MSPointerUp pointerup mouseout MSPointerOut pointerout touchend", j, h), l.data({ bindEvent_buttonsContinuous_x: !1 }), l.data("bindEvent_buttonsPixels_x") || (w.bind("click", (function (x) { x.preventDefault(), r(Math.abs(q.position().left) + l.data("scrollButtons_scrollAmount")) })), D.bind("click", (function (x) { x.preventDefault(), r(Math.abs(q.position().left) - l.data("scrollButtons_scrollAmount")) })), l.data({ bindEvent_buttonsPixels_x: !0 }))) : (f.add(A).unbind("mousedown touchstart MSPointerDown pointerdown mouseup MSPointerUp pointerup mouseout MSPointerOut pointerout touchend", j, h), l.data({ bindEvent_buttonsContinuous_y: !1 }), l.data("bindEvent_buttonsPixels_y") || (f.bind("click", (function (x) { x.preventDefault(), r(Math.abs(q.position().top) + l.data("scrollButtons_scrollAmount")) })), A.bind("click", (function (x) { x.preventDefault(), r(Math.abs(q.position().top) - l.data("scrollButtons_scrollAmount")) })), l.data({ bindEvent_buttonsPixels_y: !0 }))) } else { if (l.data("horizontalScroll")) { if (w.add(D).unbind("click"), l.data({ bindEvent_buttonsPixels_x: !1 }), !l.data("bindEvent_buttonsContinuous_x")) { w.bind("mousedown touchstart MSPointerDown pointerdown", (function (y) { y.preventDefault(); var x = B(); l.data({ mCSB_buttonScrollRight: setInterval((function () { l.mCustomScrollbar("scrollTo", Math.abs(q.position().left) + x, { trigger: "internal", scrollEasing: "easeOutCirc" }) }), 17) }) })); var j = function (x) { x.preventDefault(), clearInterval(l.data("mCSB_buttonScrollRight")) }; w.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout", j), D.bind("mousedown touchstart MSPointerDown pointerdown", (function (y) { y.preventDefault(); var x = B(); l.data({ mCSB_buttonScrollLeft: setInterval((function () { l.mCustomScrollbar("scrollTo", Math.abs(q.position().left) - x, { trigger: "internal", scrollEasing: "easeOutCirc" }) }), 17) }) })); var h = function (x) { x.preventDefault(), clearInterval(l.data("mCSB_buttonScrollLeft")) }; D.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout", h), l.data({ bindEvent_buttonsContinuous_x: !0 }) } } else if (f.add(A).unbind("click"), l.data({ bindEvent_buttonsPixels_y: !1 }), !l.data("bindEvent_buttonsContinuous_y")) { f.bind("mousedown touchstart MSPointerDown pointerdown", (function (y) { y.preventDefault(); var x = B(); l.data({ mCSB_buttonScrollDown: setInterval((function () { l.mCustomScrollbar("scrollTo", Math.abs(q.position().top) + x, { trigger: "internal", scrollEasing: "easeOutCirc" }) }), 17) }) })); var u = function (x) { x.preventDefault(), clearInterval(l.data("mCSB_buttonScrollDown")) }; f.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout", u), A.bind("mousedown touchstart MSPointerDown pointerdown", (function (y) { y.preventDefault(); var x = B(); l.data({ mCSB_buttonScrollUp: setInterval((function () { l.mCustomScrollbar("scrollTo", Math.abs(q.position().top) - x, { trigger: "internal", scrollEasing: "easeOutCirc" }) }), 17) }) })); var g = function (x) { x.preventDefault(), clearInterval(l.data("mCSB_buttonScrollUp")) }; A.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout", g), l.data({ bindEvent_buttonsContinuous_y: !0 }) } function B() { var x = l.data("scrollButtons_scrollSpeed"); return "auto" === l.data("scrollButtons_scrollSpeed") && (x = Math.round((l.data("scrollInertia") + 100) / 40)), x } } l.data("autoScrollOnFocus") && (l.data("bindEvent_focusin") || (i.bind("focusin", (function () { i.scrollTop(0).scrollLeft(0); var x = c(document.activeElement); if (x.is("input,textarea,select,button,a[tabindex],area,object")) { var J = q.position().top, y = x.position().top, I = i.height() - x.outerHeight(); l.data("horizontalScroll") && (J = q.position().left, y = x.position().left, I = i.width() - x.outerWidth()), (J + y < 0 || J + y > I) && l.mCustomScrollbar("scrollTo", y, { trigger: "internal" }) } })), l.data({ bindEvent_focusin: !0 }))), l.data("autoHideScrollbar") && !l.data("alwaysShowScrollbar") && (l.data("bindEvent_autoHideScrollbar") || (i.bind("mouseenter", (function (x) { i.addClass("mCS-mouse-over"), d.showScrollbar.call(i.children(".mCSB_scrollTools")) })).bind("mouseleave touchend", (function (x) { i.removeClass("mCS-mouse-over"), "mouseleave" === x.type && d.hideScrollbar.call(i.children(".mCSB_scrollTools")) })), l.data({ bindEvent_autoHideScrollbar: !0 }))) }, scrollTo: function (e, f) { var i = c(this), o = { moveDragger: !1, trigger: "external", callbacks: !0, scrollInertia: i.data("scrollInertia"), scrollEasing: i.data("scrollEasing") }, f = c.extend(o, f), p, g = i.children(".mCustomScrollBox"), k = g.children(".mCSB_container"), r = g.children(".mCSB_scrollTools"), j = r.children(".mCSB_draggerContainer"), h = j.children(".mCSB_dragger"), t = draggerSpeed = f.scrollInertia, q, s, m, l; if (!k.hasClass("mCS_no_scrollbar") && (i.data({ mCS_trigger: f.trigger }), i.data("mCS_Init") && (f.callbacks = !1), e || 0 === e)) { var v, n, n; if ("number" == typeof e) f.moveDragger ? (p = e, e = i.data("horizontalScroll") ? h.position().left * i.data("scrollAmount") : h.position().top * i.data("scrollAmount"), draggerSpeed = 0) : p = e / i.data("scrollAmount"); else if ("string" == typeof e) p = 1 === (v = "top" === e ? 0 : "bottom" !== e || i.data("horizontalScroll") ? "left" === e ? 0 : "right" === e && i.data("horizontalScroll") ? k.outerWidth() - g.width() : "first" === e ? i.find(".mCSB_container").find(":first") : "last" === e ? i.find(".mCSB_container").find(":last") : i.find(e) : k.outerHeight() - g.height()).length ? (e = i.data("horizontalScroll") ? v.position().left : v.position().top) / i.data("scrollAmount") : e = v; if (i.data("horizontalScroll")) i.data("onTotalScrollBack_Offset") && (s = -i.data("onTotalScrollBack_Offset")), i.data("onTotalScroll_Offset") && (l = g.width() - k.outerWidth() + i.data("onTotalScroll_Offset")), p < 0 ? (p = e = 0, clearInterval(i.data("mCSB_buttonScrollLeft")), s || (q = !0)) : p >= j.width() - h.width() ? (p = j.width() - h.width(), e = g.width() - k.outerWidth(), clearInterval(i.data("mCSB_buttonScrollRight")), l || (m = !0)) : e = -e, (n = i.data("snapAmount")) && (e = Math.round(e / n) * n - i.data("snapOffset")), d.mTweenAxis.call(this, h[0], "left", Math.round(p), draggerSpeed, f.scrollEasing), d.mTweenAxis.call(this, k[0], "left", Math.round(e), t, f.scrollEasing, { onStart: function () { f.callbacks && !i.data("mCS_tweenRunning") && u("onScrollStart"), i.data("autoHideScrollbar") && !i.data("alwaysShowScrollbar") && d.showScrollbar.call(r) }, onUpdate: function () { f.callbacks && u("whileScrolling") }, onComplete: function () { f.callbacks && (u("onScroll"), (q || s && k.position().left >= s) && u("onTotalScrollBack"), (m || l && k.position().left <= l) && u("onTotalScroll")), h.data("preventAction", !1), i.data("mCS_tweenRunning", !1), i.data("autoHideScrollbar") && !i.data("alwaysShowScrollbar") && (g.hasClass("mCS-mouse-over") || d.hideScrollbar.call(r)) } }); else i.data("onTotalScrollBack_Offset") && (s = -i.data("onTotalScrollBack_Offset")), i.data("onTotalScroll_Offset") && (l = g.height() - k.outerHeight() + i.data("onTotalScroll_Offset")), p < 0 ? (p = e = 0, clearInterval(i.data("mCSB_buttonScrollUp")), s || (q = !0)) : p >= j.height() - h.height() ? (p = j.height() - h.height(), e = g.height() - k.outerHeight(), clearInterval(i.data("mCSB_buttonScrollDown")), l || (m = !0)) : e = -e, (n = i.data("snapAmount")) && (e = Math.round(e / n) * n - i.data("snapOffset")), d.mTweenAxis.call(this, h[0], "top", Math.round(p), draggerSpeed, f.scrollEasing), d.mTweenAxis.call(this, k[0], "top", Math.round(e), t, f.scrollEasing, { onStart: function () { f.callbacks && !i.data("mCS_tweenRunning") && u("onScrollStart"), i.data("autoHideScrollbar") && !i.data("alwaysShowScrollbar") && d.showScrollbar.call(r) }, onUpdate: function () { f.callbacks && u("whileScrolling") }, onComplete: function () { f.callbacks && (u("onScroll"), (q || s && k.position().top >= s) && u("onTotalScrollBack"), (m || l && k.position().top <= l) && u("onTotalScroll")), h.data("preventAction", !1), i.data("mCS_tweenRunning", !1), i.data("autoHideScrollbar") && !i.data("alwaysShowScrollbar") && (g.hasClass("mCS-mouse-over") || d.hideScrollbar.call(r)) } }); i.data("mCS_Init") && i.data({ mCS_Init: !1 }) } function u(w) { if (i.data("mCustomScrollbarIndex")) switch (this.mcs = { top: k.position().top, left: k.position().left, draggerTop: h.position().top, draggerLeft: h.position().left, topPct: Math.round(100 * Math.abs(k.position().top) / Math.abs(k.outerHeight() - g.height())), leftPct: Math.round(100 * Math.abs(k.position().left) / Math.abs(k.outerWidth() - g.width())) }, w) { case "onScrollStart": i.data("mCS_tweenRunning", !0).data("onScrollStart_Callback").call(i, this.mcs); break; case "whileScrolling": i.data("whileScrolling_Callback").call(i, this.mcs); break; case "onScroll": i.data("onScroll_Callback").call(i, this.mcs); break; case "onTotalScrollBack": i.data("onTotalScrollBack_Callback").call(i, this.mcs); break; case "onTotalScroll": i.data("onTotalScroll_Callback").call(i, this.mcs) } } }, stop: function () { var g = c(this), e = g.children().children(".mCSB_container"), f = g.children().children().children().children(".mCSB_dragger"); d.mTweenAxisStop.call(this, e[0]), d.mTweenAxisStop.call(this, f[0]) }, disable: function (e) { var j = c(this), f = j.children(".mCustomScrollBox"), h = f.children(".mCSB_container"), g = f.children(".mCSB_scrollTools"), i = g.children().children(".mCSB_dragger"); f.unbind("mousewheel focusin mouseenter mouseleave touchend"), h.unbind("touchstart touchmove"), e && (j.data("horizontalScroll") ? i.add(h).css("left", 0) : i.add(h).css("top", 0)), g.css("display", "none"), h.addClass("mCS_no_scrollbar"), j.data({ bindEvent_mousewheel: !1, bindEvent_focusin: !1, bindEvent_content_touch: !1, bindEvent_autoHideScrollbar: !1 }).addClass("mCS_disabled") }, destroy: function () { var e = c(this); e.removeClass("mCustomScrollbar _mCS_" + e.data("mCustomScrollbarIndex")).addClass("mCS_destroyed").children().children(".mCSB_container").unwrap().children().unwrap().siblings(".mCSB_scrollTools").remove(), c(document).unbind("mousemove." + e.data("mCustomScrollbarIndex") + " mouseup." + e.data("mCustomScrollbarIndex") + " MSPointerMove." + e.data("mCustomScrollbarIndex") + " MSPointerUp." + e.data("mCustomScrollbarIndex")), c(window).unbind("resize." + e.data("mCustomScrollbarIndex")) } }, d = { showScrollbar: function () { this.stop().animate({ opacity: 1 }, "fast") }, hideScrollbar: function () { this.stop().animate({ opacity: 0 }, "fast") }, mTweenAxis: function (g, i, h, f, o, y) { var y, v = (y = y || {}).onStart || function () { }, p = y.onUpdate || function () { }, w = y.onComplete || function () { }, n = t(), l, j = 0, r = g.offsetTop, s = g.style; "left" === i && (r = g.offsetLeft); var m = h - r; function t() { return window.performance && window.performance.now ? window.performance.now() : window.performance && window.performance.webkitNow ? window.performance.webkitNow() : Date.now ? Date.now() : (new Date).getTime() } function x() { j || v.call(), j = t() - n, u(), j >= g._time && (g._time = j > g._time ? j + l - (j - g._time) : j + l - 1, g._time < j + 1 && (g._time = j + 1)), g._time < f ? g._id = _request(x) : w.call() } function u() { f > 0 ? (g.currVal = k(g._time, r, m, f, o), s[i] = Math.round(g.currVal) + "px") : s[i] = h + "px", p.call() } function e() { l = 1e3 / 60, g._time = j + l, _request = window.requestAnimationFrame ? window.requestAnimationFrame : function (z) { return u(), setTimeout(z, .01) }, g._id = _request(x) } function q() { null != g._id && (window.requestAnimationFrame ? window.cancelAnimationFrame(g._id) : clearTimeout(g._id), g._id = null) } function k(B, A, F, E, C) { switch (C) { case "linear": return F * B / E + A; case "easeOutQuad": return -F * (B /= E) * (B - 2) + A; case "easeInOutQuad": return (B /= E / 2) < 1 ? F / 2 * B * B + A : -F / 2 * (--B * (B - 2) - 1) + A; case "easeOutCubic": return B /= E, F * (--B * B * B + 1) + A; case "easeOutQuart": return B /= E, -F * (--B * B * B * B - 1) + A; case "easeOutQuint": return B /= E, F * (--B * B * B * B * B + 1) + A; case "easeOutCirc": return B /= E, B--, F * Math.sqrt(1 - B * B) + A; case "easeOutSine": return F * Math.sin(B / E * (Math.PI / 2)) + A; case "easeOutExpo": return F * (1 - Math.pow(2, -10 * B / E)) + A; case "mcsEaseOut": var D = (B /= E) * B, z = D * B; return A + F * (.499999999999997 * z * D + -2.5 * D * D + 5.5 * z + -6.5 * D + 4 * B); case "draggerRailEase": return (B /= E / 2) < 1 ? F / 2 * B * B * B + A : F / 2 * ((B -= 2) * B * B + 2) + A } } q(), e() }, mTweenAxisStop: function (e) { null != e._id && (window.requestAnimationFrame ? window.cancelAnimationFrame(e._id) : clearTimeout(e._id), e._id = null) }, rafPolyfill: function () { for (var f = ["ms", "moz", "webkit", "o"], e = f.length; --e > -1 && !window.requestAnimationFrame;)window.requestAnimationFrame = window[f[e] + "RequestAnimationFrame"], window.cancelAnimationFrame = window[f[e] + "CancelAnimationFrame"] || window[f[e] + "CancelRequestAnimationFrame"] } }; d.rafPolyfill.call(), c.support.touch = !!("ontouchstart" in window), c.support.pointer = window.navigator.pointerEnabled, c.support.msPointer = window.navigator.msPointerEnabled; var a = "https:" == document.location.protocol ? "https:" : "http:"; c.event.special.mousewheel || document.write('<script src="' + a + '//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.0.6/jquery.mousewheel.min.js"><\/script>'), c.fn.mCustomScrollbar = function (e) { return b[e] ? b[e].apply(this, Array.prototype.slice.call(arguments, 1)) : "object" != typeof e && e ? void c.error("Method " + e + " does not exist") : b.init.apply(this, arguments) } }(jQuery), jQuery.cookie = function (b, j, m) { if (void 0 === j) { var d = null; if (document.cookie && "" != document.cookie) for (var k = document.cookie.split(";"), h = 0; h < k.length; h++) { var c = jQuery.trim(k[h]); if (c.substring(0, b.length + 1) == b + "=") { d = decodeURIComponent(c.substring(b.length + 1)); break } } return d } m = m || {}, null === j && (j = "", m.expires = -1); var e = "", f; m.expires && ("number" == typeof m.expires || m.expires.toUTCString) && ("number" == typeof m.expires ? (f = new Date).setTime(f.getTime() + 24 * m.expires * 60 * 60 * 1e3) : f = m.expires, e = "; expires=" + f.toUTCString()); var l = m.path ? "; path=" + m.path : "", g = m.domain ? "; domain=" + m.domain : "", a = m.secure ? "; secure" : ""; document.cookie = [b, "=", encodeURIComponent(j), e, l, g, a].join("") }; var lzxPlayerInit = function () { var isPhone = !1, isTest = "undefined" != typeof lzxPlayerTest && lzxPlayerTest, testKey = "undefined" != typeof lzxPlayerTestKey ? lzxPlayerTestKey : null, styleLoaded = "undefined" != typeof lzxPlayerStyleLoaded && lzxPlayerStyleLoaded; if (navigator.userAgent.match(/(iPhone|iPod|Android|ios|Nokia|Black Berry|MIDP|Phone)/i) && (isPhone = !0), !isTest) { var isLoad = localStorage.getItem("isLoad"), lastFeed = localStorage.getItem("lastFeed"); if (isLoad = (isLoad = void 0 !== isLoad && "true" === isLoad) && void 0 !== lastFeed && (new Date).getTime() - parseInt(lastFeed) < 2e3, top.location !== self.location || isLoad) return; localStorage.setItem("isLoad", "true") } if (!isTest || null != testKey) { var jsUrl = $("#ilt").attr("src"), webURL = jsUrl.startsWith("http") ? jsUrl.substring(0, jsUrl.indexOf("/", 8)) : window.location.origin, keyId = isTest ? testKey : $("#ilt").attr("key"); styleLoaded || ($("head").append('<link rel="stylesheet" type="text/css" href="' + webURL + '/player/css/player.css">'), $("head").append('<link href="https://libs.baidu.com/fontawesome/4.2.0/css/font-awesome.css" rel="stylesheet" type="text/css">'), lzxPlayerStyleLoaded = !0), $("body").append('<div id="lzxPlayer">\n    <div class="player">\n        <canvas class="blur-img" width="365" height="155" id="canvas">您的浏览器不支持canvas，请更换高级版的浏览器！</canvas>\n        <div class="blur-img">\n            <img src="#" class="blur" style="top: 0; display: inline;"></div>\n        <div class="infos">\n            <div class="songstyle">\n                <span>\n                    <i class="fa fa-music"></i>\n                    <span class="song"></span>\n                </span>\n                <span style="float: right;">\n                    <i class="fa fa-clock-o"></i>\n                    <span class="time">00:00 / 00:00</span></span>\n            </div>\n            <div class="artiststyle">\n                <i class="fa fa-user"></i>\n                <span class="artist"></span>\n                <span class="moshi">\n                    <i class="loop fa fa-random current"></i> 随机播放</span>\n            </div>\n            <div class="artiststyle">\n                <i class="fa fa-folder"></i>\n                <span class="artist1"></span>\n                <span class="geci"></span>\n            </div>\n        </div>\n        <div class="control">\n            <span style="float:left">\n                <i class="loop fa fa-retweet" title="顺序播放"></i>\n                <i class="prev fa fa-backward" title="上一首"></i>\n            </span>\n            <span style="float:right">\n                <i class="next fa fa-forward" title="下一首"></i>\n                <i class="random fa fa-random current" title="随机播放"></i>\n            </span>\n        </div>\n        <div class="status">\n            <b>\n                <i class="play fa fa-play" title="播放"></i>\n                <i class="pause fa fa-pause" title="暂停"></i>\n            </b>\n            <div id="div1" class="note">\n                <i class="fa fa-music" aria-hidden="true"></i>\n            </div>\n            <div id="div2" class="note">\n                <i class="fa fa-music" aria-hidden="true"></i>\n            </div>\n            <div id="div3" class="note">\n                <i class="fa fa-music" aria-hidden="true"></i>\n            </div>\n        </div>\n        <div class="musicbottom">\n            <div class="rate">\n                <div class="progress">\n                    <div class="rate-buffered"></div>                    <div class="rate-on" style="width: 0;">\n                        <div class="drag"></div>\n                    </div>\n                </div>\n            </div>\n            <div class="icons">\n                <div class="switch-playlist">\n                    <i class="fa fa-bars" title="播放列表"></i>\n                </div>\n                <div class="switch-ksclrc">\n                    <i class="fa fa-toggle-on" title="关闭歌词"></i>\n                </div>\n                <div class="switch-down">\n                    <a class="down">\n                        <i class="fa fa-cloud-download" title="歌曲下载"></i>\n                    </a>\n                </div>\n                <div class="new-volume">\n                    <i class="volumeup fa fa-volume-up" title="音量"></i>\n                    <div class="volume-controls" style="">\n                        <div class="slider" data-direction="vertical">\n                            <div class="progress2" style="height: 66%;">\n                                <div class="drag" id="volume-drag"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="cover"></div>\n    </div>\n    <div class="playlist">\n        <div class="playlist-bd">\n            <div class="album-list">\n                <div class="musicheader"></div>\n                <div class="list"></div>\n            </div>\n            <div class="song-list">\n                <div class="musicheader">\n                    <i class="fa fa-angle-right"></i>\n                    <span></span>\n                </div>\n                <div class="list">\n                    <ul></ul>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="switch-player">\n        <i class="fa fa-angle-right" style="margin-top: 20px;"></i>\n    </div>\n</div>\n<div id="lzxTips"></div>\n<div id="lzxLrc"></div>'), mainColor = "0,0,0"; var audio = new Audio, $player = $("#lzxPlayer"), $tips = $("#lzxTips"), $lk = $("#lzxKsc,#lzxLrc"), $switchPlayer = $(".switch-player", $player), $btns = $(".status", $player), $songName = $(".song", $player), $cover = $(".cover", $player), $songTime = $(".time", $player), $songList = $(".song-list .list", $player), $albumList = $(".album-list", $player), $songFrom = $(".player .artist", $player), $songFrom1 = $(".player .artist1", $player), $songFrom2 = $(".player .moshi", $player), $songFrom3 = $(".player .geci", $player), $songFrom4 = $(".player .switch-ksclrc", $player), $volumeSlider = $(".volume-controls .slider", $player); $rateBuffered = $(".musicbottom .rate-buffered", $player), $rateSlider = $(".rate .progress", $player), songFrom33 = "开启", songFrom44 = "", songFrom55 = "", roundcolor = "#6c6971", lightcolor = "#81c300", cur = "current", ycgeci = !0, first = 1, volume = $.cookie("lzx_player_volume") ? $.cookie("lzx_player_volume") : "0.666", albumId = 0, songId = 0, songTotal = 0, random = !0, rateIsDown = !1, rateMouse = {}, rateTouch = {}, hasgeci = !0, cicleTime = null, hasLrc = !1, lrcTimeLine = [], lrcHeight = 40, lrcTime = null, lrcCont = "", dogInterval = null, songFroms = { wy: "网易音乐", kg: "酷狗音乐", qq: "QQ音乐", xm: "虾米音乐", local: "本地音乐" }, isPhone && ($("#lzxLrc").addClass("phone"), $player.addClass("phone"), $(".new-volume", $player).hide()), $cover.html('<img src="">'), $songName.html('<a style="color:#f00">正在初始化</a>'), $songFrom.html('<a style="color:#f00">www.ilt.me</a>'), $songFrom1.html('<a style="color:#f00">音乐播放器</a>'), $songFrom3.html('<i class="fa fa-times-circle"></i> 歌词未载入'), window.lzxPlayerReload = function () { try { clearInterval(cicleTime) } catch (e) { } try { clearInterval(lrcTime) } catch (e) { } try { clearInterval(dogInterval) } catch (e) { } $("#lzxPlayer").remove(), $("#lzxLrc").remove(), $("#lzxTips").remove(), audio.pause() }; var lzxMedia = { play: function () { $cover.addClass("coverplay"), $player.addClass("playing"), $rateBuffered.width(0), cicleTime = setInterval((function () { rateMouse.isDown || rateTouch.isTouchDown || ($songTime.text(formatSecond(audio.currentTime) + " / " + formatSecond(audio.duration)), $(".rate-on", $rateSlider).width(audio.currentTime / audio.duration * 100 + "%")), audio.currentTime < audio.duration / 2 ? $btns.css("background-image", "linear-gradient(90deg, " + roundcolor + " 50%, transparent 50%, transparent), linear-gradient(" + (90 + 180 / (audio.duration / 2) * audio.currentTime) + "deg, " + lightcolor + " 50%, " + roundcolor + " 50%, " + roundcolor + ")") : $btns.css("background-image", "linear-gradient(" + (90 + 180 / (audio.duration / 2) * audio.currentTime) + "deg, " + lightcolor + " 50%, transparent 50%, transparent), linear-gradient(270deg, " + lightcolor + " 50%, " + roundcolor + " 50%, " + roundcolor + ")"); var timeRanges = audio.buffered; 0 !== timeRanges.length && $rateBuffered.width(parseInt(100 * timeRanges.end(timeRanges.length - 1) / audio.duration * 100) / 100 + "%") }), 800), hasLrc && (lrcTime = setInterval(lzxLrc.lrc.play, 500), $("#lzxLrc").addClass("show"), $(".switch-down").css("right", "65px"), $(".switch-ksclrc").show()) }, pause: function () { clearInterval(cicleTime), $player.removeClass("playing"), $(".switch-ksclrc").hide(), $(".switch-down").css("right", "35px"), hasLrc && lzxLrc.lrc.hide() }, error: function () { clearInterval(cicleTime), $player.removeClass("playing"), lzxTips.show(songSheetList[albumId].songNames[songId] + " - 资源获取失败！尝试获取下一首..."), lzxMedia.next() }, seeking: function () { lzxTips.show("加载中...") }, volumechange: function () { var vol = window.parseInt(100 * audio.volume); $(".progress2", $volumeSlider).height(vol + "%"), lzxTips.show("音量：" + vol + "%"), $.cookie("lzx_player_volume", audio.volume) }, getInfos: function (id) { $cover.removeClass("coverplay"), songId = id, allmusic(), songFrom55 = songFroms[songSheetList[albumId].songTypes[songId]], musictype = songSheetList[albumId].songTypes[songId], netmusic() }, getSongId: function (n) { return n >= songTotal ? 0 : n < 0 ? songTotal - 1 : n }, next: function () { clearInterval(cicleTime), random ? lzxMedia.getInfos(window.parseInt(Math.random() * songTotal)) : lzxMedia.getInfos(lzxMedia.getSongId(songId + 1)) }, prev: function () { clearInterval(cicleTime), random ? lzxMedia.getInfos(window.parseInt(Math.random() * songTotal)) : lzxMedia.getInfos(lzxMedia.getSongId(songId - 1)) } }, lzxTipsTime = null, lzxTips = { show: function (cont) { clearTimeout(lzxTipsTime), $("#lzxTips").text(cont).addClass("show"), this.hide() }, hide: function () { lzxTipsTime = setTimeout((function () { $("#lzxTips").removeClass("show") }), 3e3) } }; audio.addEventListener("play", lzxMedia.play, !1), audio.addEventListener("pause", lzxMedia.pause, !1), audio.addEventListener("ended", lzxMedia.next, !1), audio.addEventListener("playing", lzxMedia.playing, !1), audio.addEventListener("volumechange", lzxMedia.volumechange, !1), audio.addEventListener("error", lzxMedia.error, !1), audio.addEventListener("seeking", lzxMedia.seeking, !1), $switchPlayer.click((function () { $player.toggleClass("show") })), $(".pause", $player).click((function () { hasgeci = !1, $("li", $albumList).eq(albumId).addClass(cur).find(".artist").html("暂停播放 > ").parent().siblings().removeClass(cur).find(".artist").html("").parent(), lzxTips.show("暂停播放 - " + songSheetList[albumId].songNames[songId]), $cover.removeClass("coverplay"), audio.pause(), setTimeout((function () { lzxTips.show("播放器下次访问将自动暂停") }), 4e3), $.cookie("auto_playre", "no") })), $(".play", $player).click((function () { hasgeci = !0, $("#lzxLrc,#lzxKsc").show(), $("li", $albumList).eq(albumId).addClass(cur).find(".artist").html("当前播放 > ").parent().siblings().removeClass(cur).find(".artist").html("").parent(), startPlay(), setTimeout((function () { lzxTips.show("播放器下次访问将自动播放") }), 4e3), $.cookie("auto_playre", "yes") })), $(".prev", $player).click((function () { hasgeci = !0, $("#lzxLrc,#lzxKsc").show(), lzxMedia.prev(), $.cookie("auto_playre", "yes") })), $(".next", $player).click((function () { hasgeci = !0, $("#lzxLrc,#lzxKsc").show(), lzxMedia.next(), $.cookie("auto_playre", "yes") })), $(".random", $player).click((function () { $(this).addClass(cur), $(".loop", $player).removeClass(cur), random = !0, lzxTips.show("随机播放"), $songFrom2.html('<i class="random fa fa-random current"></i> 随机播放'), $.cookie("random_play", !0) })), $(".loop", $player).click((function () { $(this).addClass(cur), $(".random", $player).removeClass(cur), random = !1, lzxTips.show("顺序播放"), $songFrom2.html('<i class="loop fa fa-retweet"></i> 顺序播放'), $.cookie("random_play", !1) })), $volumeSlider.click((function (e) { var documentTop = $(document).scrollTop(), progressHeight = $volumeSlider.height(), progressOffsetTop = $volumeSlider.offset().top - documentTop, calcVolume = (1 - (e.clientY - progressOffsetTop) / progressHeight).toFixed(2); audio.volume = calcVolume > 1 ? 1 : calcVolume })), $rateSlider.click((function (e) { var progressWidth = $rateSlider.width(), progressOffsetLeft = $rateSlider.offset().left, eClientX = e.clientX; audio.currentTime = audio.duration * ((eClientX - progressOffsetLeft) / progressWidth) })); var isDown = !1; $(".drag", $volumeSlider).mousedown((function () { isDown = !0 })), $(".drag", $rateSlider).on("touchstart", (function (e) { rateTouch.progressWidth = $rateSlider.width(), rateTouch.isTouchDown = !0, rateTouch.startX = e.originalEvent.touches[0].clientX, rateTouch.rateOnWidth = parseFloat(($(".rate-on", $rateSlider).width() / rateTouch.progressWidth).toFixed(2)) })), $(".drag", $rateSlider).mousedown((function (e) { rateMouse.progressWidth = $rateSlider.width(), rateMouse.isDown = !0, rateMouse.startX = e.clientX, rateMouse.rateOnWidth = parseFloat(($(".rate-on", $rateSlider).width() / rateMouse.progressWidth).toFixed(2)) })), window.addEventListener("touchmove", (function (e) { if (rateTouch.isTouchDown) { var rate = parseFloat(((e.touches[0].clientX - rateTouch.startX) / rateTouch.progressWidth).toFixed(2)) + rateTouch.rateOnWidth; rate >= 0 && rate <= 1 && ($(".rate-on", $rateSlider).width(100 * rate + "%"), rateTouch.currentTime = audio.duration * rate, $songTime.text(formatSecond(rateTouch.currentTime) + " / " + formatSecond(audio.duration))) } return !1 }), { passive: !1 }), $(window).on({ mousemove: function (e) { if (isDown) { var documentTop = $(document).scrollTop(), progressHeight = $volumeSlider.height(), progressOffsetTop = $volumeSlider.offset().top - documentTop, eClientY = e.clientY; eClientY >= progressOffsetTop && eClientY <= progressOffsetTop + progressHeight && (audio.volume = (1 - (eClientY - progressOffsetTop) / progressHeight).toFixed(2)) } else if (rateMouse.isDown) { var rate = parseFloat(((e.clientX - rateMouse.startX) / rateMouse.progressWidth).toFixed(2)) + rateMouse.rateOnWidth; rate >= 0 && rate <= 1 && ($(".rate-on", $rateSlider).width(100 * rate + "%"), rateMouse.currentTime = audio.duration * rate, $songTime.text(formatSecond(rateMouse.currentTime) + " / " + formatSecond(audio.duration))) } }, mouseup: function () { isDown = !1, rateMouse.isDown && (audio.currentTime = rateMouse.currentTime, rateMouse.isDown = !1) }, touchend: function (e) { rateTouch.isTouchDown && (audio.currentTime = rateTouch.currentTime, rateTouch.isTouchDown = !1) } }), $(".switch-playlist").click((function () { $player.toggleClass("showAlbumList") })), $songList.mCustomScrollbar(), $(".song-list .musicheader,.song-list .fa-angle-right", $player).click((function () { $player.removeClass("showSongList") })), $(".switch-ksclrc").click((function () { $player.toggleClass("ksclrc"), $("#lzxLrc").toggleClass("hide"), $("#lzxKsc").toggleClass("hidePlayer"), $("#lzxLrc").hasClass("hide") ? (ycgeci = !1, hasLrc && $songFrom3.html('<i class="fa fa-times-circle"></i> 歌词关闭'), lzxTips.show("歌词显示已关闭"), songFrom33 = "关闭", $songFrom4.html('<i class="fa fa-toggle-off" title="打开歌词"></i>')) : (ycgeci = !0, hasLrc && $songFrom3.html('<i class="fa fa-check-circle"></i> 歌词开启'), lzxTips.show("开启歌词显示"), songFrom33 = "开启", $songFrom4.html('<i class="fa fa-toggle-on" title="关闭歌词"></i>')), musicTooltip() })), lzxPlayer.playList = { creat: { album: function () { $(".musicheader", $albumList).html(siteName + " - 专辑列表"); for (var albumTotal = songSheetList.length, albumList = "", c = 0; c < albumTotal; c++)albumList += '<li><i class="fa fa-angle-right"></i><span class="index">' + (c + 1) + '</span><span class="artist"></span>《' + songSheetList[c].songSheetName + "》 - " + songSheetList[c].author + "</li>"; $(".list", $albumList).html("<ul>" + albumList + "</ul>").mCustomScrollbar(), $("li", $albumList).click((function () { var a = $(this).index(); $(this).hasClass(cur) ? lzxPlayer.playList.creat.song(a, !0) : lzxPlayer.playList.creat.song(a, !1), $player.addClass("showSongList") })), songTotal = songSheetList[albumId].songIds.length, random ? lzxMedia.getInfos(window.parseInt(Math.random() * songTotal)) : lzxMedia.getInfos(lzxMedia.getSongId(0)) }, song: function (id, isThisAlbum) { songTotal = songSheetList[id].songIds.length, $(".song-list .musicheader span", $player).text(songSheetList[id].songSheetName + "(" + songTotal + ")"); for (var songList = "", i = 0; i < songTotal; i++)songList += '<li><span class="index">' + (i + 1) + '</span><span class="artist"></span>' + songSheetList[id].songNames[i] + "</li>"; $("ul", $songList).html(songList), $songList.mCustomScrollbar("update"), isThisAlbum ? ($("li", $songList).eq(songId).addClass(cur).siblings().removeClass(cur), $songList.mCustomScrollbar("scrollTo", $("li.current", $songList).position().top - 120)) : $songList.mCustomScrollbar("scrollTo", "top"), $("li", $songList).click((function () { hasgeci = !0, $("#lzxLrc,#lzxKsc").show(), albumId = id, $(this).hasClass(cur) ? lzxTips.show("正在播放 - " + songSheetList[albumId].songNames[songId].replace(songId + 1 + "#", "")) : ($.cookie("auto_playre", "yes"), songId = $(this).index(), lzxMedia.getInfos(songId)) })) } } }; var lzxLrc = { load: function () { lzxLrc.lrc.hide(), hasLrc = !1, $("#lzxLrc,#lzxKsc").html(""), setTimeout((function () { hasgeci ? $songFrom3.html('<i class="fa fa-check-circle"></i> 歌词' + songFrom33) : $songFrom3.html('<i class="fa fa-times-circle"></i> 歌词' + songFrom33), $(".switch-down").css("right", "65px"), $(".switch-ksclrc").show(), $.ajax({ url: webURL + "/api/musicLyric?songId=" + songSheetList[albumId].songIds[songId] + "&type=" + songSheetList[albumId].songTypes[songId], type: "GET", dataType: "script", success: function () { "" == lrcstr ? (songFrom44 = " - 暂无歌词!", $songFrom3.html('<i class="fa fa-times-circle"></i> 暂无歌词'), $(".switch-ksclrc").hide(), $(".switch-down").css("right", "35px")) : lrcstr.indexOf("[00") >= 0 ? setTimeout((function () { $("#lzxLrc").hasClass("hide") ? songFrom44 = " - 歌词已关闭！" : songFrom44 = " - 歌词获取成功!", lzxLrc.lrc.format(lrcstr) }), 500) : (songFrom44 = " - 暂无歌词!", $songFrom3.html('<i class="fa fa-times-circle"></i> 暂无歌词'), $(".switch-ksclrc").hide(), $(".switch-down").css("right", "35px")) }, error: function () { songFrom44 = " - 暂无歌词!", $songFrom3.html('<i class="fa fa-times-circle"></i> 暂无歌词'), $(".switch-ksclrc").hide(), $(".switch-down").css("right", "35px") } }) }), 50) }, lrc: { format: function (cont) { function formatTime(t) { var sp = t.split(":"), min = +sp[0], sec = +sp[1].split(".")[0], ksec = +sp[1].split(".")[1]; return 60 * min + sec + Math.round(ksec / 1e3) } hasLrc = !0; var lrcCont = cont.replace(/\[[A-Za-z]+:(.*?)]/g, "").split(/[\]\[]/g), lrcLine = ""; lrcTimeLine = []; for (var i = 1; i < lrcCont.length; i += 2) { var timer = formatTime(lrcCont[i]); lrcTimeLine.push(timer), lrcLine += 1 == i ? '<li class="lzxLrc' + timer + ' current" style="color:rgba(' + mainColor + ',1)">' + lrcCont[i + 1] + "</li>" : '<li class="lzxLrc' + timer + '">' + lrcCont[i + 1] + "</li>" } $("#lzxLrc").html("<ul>" + lrcLine + "</ul>"), setTimeout((function () { audio.paused ? ($(".switch-ksclrc").hide(), $(".switch-down").css("right", "35px")) : $("#lzxLrc").addClass("show") }), 500), lrcTime = setInterval(lzxLrc.lrc.play, 500) }, play: function () { var timeNow = Math.round(audio.currentTime); if ($.inArray(timeNow, lrcTimeLine) > 0) { var $lineNow = $(".lzxLrc" + timeNow); $lineNow.hasClass(cur) || ($lineNow.css("color", "rgba(" + mainColor + ",1)"), $lineNow.addClass(cur).siblings().removeClass(cur).css("color", ""), $("#lzxLrc").animate({ scrollTop: lrcHeight * $lineNow.index() })) } else lrcCont = "" }, hide: function () { clearInterval(lrcTime), $("#lzxLrc").removeClass("show") } } }; audio.volume = volume, 1 == volume && $(".volume-on", $player).width("100%"), $.ajax({ url: webURL + "/api/info?id=" + keyId, type: "GET", dataType: "script", success: function () { -1 !== playerWidth && document.body.style.setProperty("--player-width", playerWidth + "px"), -1 !== coverWidth && document.body.style.setProperty("--cover-width", coverWidth + "px"), 1 !== showNotes && $(".status .note", $player).hide(), -1 !== autoPopupPlayer && setTimeout((function () { $player.addClass("show") }), 1e3 * autoPopupPlayer), null != $.cookie("random_play") ? "true" == $.cookie("random_play") ? ($(".loop", $player).removeClass(cur), $(".random", $player).addClass(cur), $songFrom2.html('<i class="random fa fa-random"></i> 随机播放'), random = !0) : ($(".loop", $player).addClass(cur), $(".random", $player).removeClass(cur), $songFrom2.html('<i class="loop fa fa-retweet"></i> 顺序播放'), random = !1) : 1 != randomPlayer && ($(".loop", $player).addClass(cur), $(".random", $player).removeClass(cur), random = !1, $songFrom2.html('<i class="loop fa fa-retweet"></i> 顺序播放')), "0.666" == $.cookie("lzx_player_volume") && (volume = defaultVolume / 100, audio.volume = volume), lzxMedia.volumechange(), albumId = defaultAlbum - 1, 0 == showLrc && ($("#lzxLrc").addClass("hide"), ycgeci = !1, hasLrc && $songFrom3.html('<i class="fa fa-times-circle"></i> 歌词关闭'), lzxTips.show("歌词显示已关闭"), songFrom33 = "关闭", $songFrom4.html('<i class="fa fa-toggle-off" title="打开歌词"></i>')), 1 == showGreeting && lzxTips.show(greeting), setTimeout((function (args) { lzxPlayer.playList.creat.album() }), 500) }, error: function (XMLHttpRequest, textStatus, errorThrown) { lzxTips.show("歌曲列表获取失败!") } }), dogInterval = setInterval((function () { isTest || localStorage.setItem("lastFeed", (new Date).getTime().toString()); var currPlayerWidth = document.body.style.getPropertyValue("--player-width"); "undefined" != typeof playerWidth && -1 !== playerWidth && currPlayerWidth != playerWidth + "px" && document.body.style.setProperty("--player-width", playerWidth + "px"); var currCoverWidth = document.body.style.getPropertyValue("--cover-width"); "undefined" != typeof coverWidth && -1 !== coverWidth && currCoverWidth != coverWidth + "px" && document.body.style.setProperty("--cover-width", coverWidth + "px") }), 1e3), window.addEventListener("beforeunload", (function (event) { localStorage.setItem("isLoad", "false") }), !0) } function formatSecond(t) { return ("00" + Math.floor(t / 60)).substr(-2) + ":" + ("00" + Math.floor(t % 60)).substr(-2) } function LimitStr(str, num, t) { num = num || 6, t = t || "..."; for (var re = "", leg = str.length, h = 0, i = 0; h < 2 * num && i < leg; i++)h += str.charCodeAt(i) > 128 ? 2 : 1, re += str.charAt(i); return i < leg && (re += t), re } function netmusic() { audio.src = webURL + "/api/musicUrl?songId=" + songSheetList[albumId].songIds[songId] + "&type=" + songSheetList[albumId].songTypes[songId], $(".switch-down").show(), $(".switch-down").html('<a class="down"><i class="fa fa-cloud-download" title="从' + songFrom55 + "下载：" + songSheetList[albumId].songNames[songId] + " - " + songSheetList[albumId].artistNames[songId] + '"></i></a>'), $(".down").click((function () { window.open(audio.src, "newwindow") })), $songName.html('<span title="' + songSheetList[albumId].songNames[songId] + '">' + LimitStr(songSheetList[albumId].songNames[songId]) + "</span>"), window.console.log(name + " - 当前播放：" + songSheetList[albumId].songNames[songId] + " - " + songSheetList[albumId].artistNames[songId]), $songFrom.html('<span title="' + songSheetList[albumId].artistNames[songId] + '">' + LimitStr(songSheetList[albumId].artistNames[songId]) + "</span>"), $songFrom1.html('<span title="' + songSheetList[albumId].albumNames[songId] + '">' + LimitStr(songSheetList[albumId].albumNames[songId]) + "</span>"); var coverImg = new Image; coverImg.src = songSheetList[albumId].albumCovers[songId], $cover.addClass("changing"), coverImg.onload = function () { $cover.removeClass("changing"), $.ajax({ url: webURL + "/api/mainColor", type: "GET", dataType: "script", data: { url: coverImg.src }, success: function () { playerColor() }, error: function () { playerColor() } }) }, coverImg.error = function () { coverImg.src = "/content/plugins/Fw_player/style/logo.png", setTimeout((function () { lzxTips.show(songSheetList[albumId].songNames[songId] + " - 专辑图片获取失败！") }), 4e3) }, $cover.html(coverImg), 1 == background ? $(".blur-img .blur", $player).attr("src", songSheetList[albumId].albumCovers[songId]) : $(".blur-img").length > 0 && $(".blur-img").remove(), lzxLrc.load(), 1 == first ? (first = 2, 1 != autoPlayer || null != $.cookie("auto_playre") && "yes" !== $.cookie("auto_playre") ? (lzxTips.show("播放器自动暂停"), $cover.removeClass("coverplay"), audio.pause()) : startPlay()) : startPlay(), $(window).scroll((function () { var scrollTop = $(this).scrollTop(), scrollHeight = $(window.document).height(), windowHeight; scrollTop + $(this).height() == scrollHeight ? hasgeci && ycgeci && ($player.addClass("ksclrc"), $("#lzxLrc").addClass("hide"), $("#lzxKsc").addClass("hidePlayer"), $songFrom3.html('<i class="fa fa-times-circle"></i> 歌词隐藏'), $songFrom4.html('<i class="fa fa-toggle-off" title="歌词隐藏"></i>'), hasLrc && lzxTips.show("歌词自动隐藏")) : hasgeci && ycgeci && ($player.removeClass("ksclrc"), $("#lzxLrc").removeClass("hide"), $("#lzxKsc").removeClass("hidePlayer"), hasLrc && $songFrom3.html('<i class="fa fa-check-circle"></i> 歌词开启'), $songFrom4.html('<i class="fa fa-toggle-on" title="关闭歌词"></i>')) })), musicTooltip() } function startPlay() { lzxTips.show("开始从" + songFrom55 + "播放 - " + songSheetList[albumId].songNames[songId]), audio.play() } function allmusic() { $("li", $albumList).eq(albumId).addClass(cur).find(".artist").html("当前播放 > ").parent().siblings().removeClass(cur).find(".artist").html("").parent(), $songList.find("li").eq(songId).addClass(cur).siblings().removeClass(cur), "" != $("ul", $songList).html() && $songList.mCustomScrollbar("scrollTo", $("li.current", $songList).position().top - 120) } function playerColor() { $player.css({ background: "rgba(" + mainColor + ",.8)" }), $switchPlayer.css({ background: "rgba(" + mainColor + ",.3)" }), $tips.css({ background: "rgba(" + mainColor + ",.6)" }), $lk.css({ background: "rgba(" + mainColor + ",.3)" }), $(".infos,.control,.status .note", $player).css({ color: "rgb(" + font_color + ")" }) } function musicTooltip() { isPhone || $("#lzxPlayer span,#lzxPlayer i").each((function () { if ($("#tooltip").remove(), this.title) { var a = this.title; $(this).unbind("mouseover mouseout"), $(this).mouseover((function (b) { this.title = "", $("body").append('<div id="tooltip">' + a + "</div>"), $("#tooltip").css({ left: b.pageX - 15 + "px", top: b.pageY + 30 + "px", opacity: "0.8" }).fadeIn(250) })).mouseout((function () { this.title = a, $("#tooltip").remove() })).mousemove((function (b) { $("#tooltip").css({ left: b.pageX - 15 + "px", top: b.pageY + 30 + "px" }) })) } })) } }; lzxPlayerInit();